(this["webpackJsonpkml-viewer"]=this["webpackJsonpkml-viewer"]||[]).push([[0],{107:function(e,t,a){},110:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(12),l=a.n(o),c=a(23),s=a(68),i=a(31),u=a(32),h=a(37),m=a(35),d=a(82),p=a(4),f=a(156),E=a(160),g=a(175),k=a(177),y=a(169),v=a(157),b=a(167),M=a(179),T=a(114),w=a(112),S=a(113),O=a(166),A=a(163),C=a(162),I=a(168),x=a(165),j=a(164),N=a(180),B=a(181),R=a(170),z=a(176),P=a(161),D=a(44),G=a(171),L=a(174),F=a(173),H=a(172),W=a(80),U=a.n(W),V=a(81),Y=a.n(V),q=a(67),J=a.n(q),_=a(83);var K=function(e){var t=e.onNewTrack,a=Object(r.useCallback)((function(e){e.forEach((function(e){var a=new FileReader;a.onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.onload=function(){var r=function(e){var t=(new DOMParser).parseFromString(e,"text/xml"),a=[];if("kml"===t.documentElement.nodeName){var r,n=Object(c.a)(t.getElementsByTagName("Placemark"));try{for(n.s();!(r=n.n()).done;){var o=r.value,l=o.getElementsByTagName("LineString");l.length||(l=o.getElementsByTagName("Linestring"));var s,i=Object(c.a)(l);try{for(i.s();!(s=i.n()).done;){var u,h=s.value.getElementsByTagName("coordinates")[0].childNodes[0].nodeValue.trim().split("\n"),m=Object(c.a)(h);try{for(m.s();!(u=m.n()).done;){var d=u.value.split(",");0===+d[1]||0===+d[0]||isNaN(+d[1])||isNaN(+d[0])||a.push([+d[1],+d[0]])}}catch(p){m.e(p)}finally{m.f()}}}catch(p){i.e(p)}finally{i.f()}}}catch(p){n.e(p)}finally{n.f()}}return a}(a.result);r.length>0&&t(e.path,r)},a.readAsText(e)}))}),[t]),o=Object(_.a)({onDrop:a}),l=o.getRootProps,s=o.getInputProps;return n.a.createElement("div",l({className:"dropzone"}),n.a.createElement("input",s()),n.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files"))},X=a(84),Q=a(183),Z=a(184),$=a(185),ee=a(14),te=a.n(ee),ae=a(178),re=a(182),ne=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return n.a.createElement(ae.a,{color:this.props.color,weight:this.props.weight,positions:this.props.positions,dashArray:this.props.dashArray},this.props.popup&&n.a.createElement(re.a,null,this.props.popup))}}]),a}(r.Component);function oe(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Error("Input argument must be an array of lat/lng pairs.");Array.isArray(e[0][0])||(e=[e]);var t,a=te.a.latLngBounds(te.a.latLng(e[0][0][0],e[0][0][1]),te.a.latLng(e[0][0][0],e[0][0][1])),r=Object(c.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=te.a.polyline(n);a.extend(o.getBounds())}}catch(l){r.e(l)}finally{r.f()}return a}var le=Q.a.BaseLayer,ce=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={center:[51.505,-.09],zoom:13},e.mapRef=Object(r.createRef)(),e}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props.tracks.map((function(e){return Object(X.a)({popup:n.a.createElement(r.Fragment,null,n.a.createElement("strong",null,e.name),n.a.createElement("br",null),e.distance.toFixed(2)," km")},e)})),t=te.a.latLngBounds([-90,90],[-180,180]),a=!1;if(null!=this.mapRef.current&&(t=this.mapRef.current.leafletElement.getBounds()),this.props.autofit){var o,l=Object(c.a)(this.props.tracks);try{for(l.s();!(o=l.n()).done;){var s=o.value;s.checked&&(a?t.extend(oe(s.positions)):(a=!0,t=oe(s.positions)))}}catch(i){l.e(i)}finally{l.f()}}return n.a.createElement(Z.a,{bounds:t,ref:this.mapRef},n.a.createElement(Q.a,{position:"topright"},n.a.createElement(le,{checked:!0,name:"OpenStreetMap"},n.a.createElement($.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})),n.a.createElement(le,{name:"OpenStreetMap (de)"},n.a.createElement($.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"//{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png"})),n.a.createElement(le,{name:"OpenStreetMap (hot)"},n.a.createElement($.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"//{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"})),n.a.createElement(le,{name:"OpenTopoMap"},n.a.createElement($.a,{attribution:'Map data: &copy <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>',url:"//{s}.tile.opentopomap.org/{z}/{x}/{y}.png"})),n.a.createElement(le,{name:"HikeBikeMap"},n.a.createElement($.a,{attribution:'&copy <a href="http://www.opencyclemap.org">OpenCycleMap</a>, &copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://tiles.wmflabs.org/hikebike/{z}/{x}/{y}.png"})),n.a.createElement(le,{name:"Hydda"},n.a.createElement($.a,{attribution:'&copy <a href="http://openstreetmap.se/">OpenStreetMap Sweden</a>, &copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"//{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png"})),n.a.createElement(le,{name:"Carto"},n.a.createElement($.a,{attribution:'Map tiles by <a href="http://cartodb.com/attributions">CartoDB</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>, &copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png"})),n.a.createElement(le,{name:"EsriSatellite"},n.a.createElement($.a,{attribution:"Tiles &copy Esri &mdash Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"//server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"})),n.a.createElement(le,{name:"StamenTerrain"},n.a.createElement($.a,{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>, , &copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"//stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"}))),e.filter((function(e){return e.checked})).map((function(e,t){return n.a.createElement(ne,{key:e.name,color:e.color,weight:e.weight,positions:e.positions,dashArray:e.dashArray,popup:e.popup})})))}}]),a}(r.Component);function se(e,t,a,r){if(e===a&&t===r)return 0;var n=e*Math.PI/180,o=a*Math.PI/180,l=(a-e)*Math.PI/180,c=(r-t)*Math.PI/180,s=Math.sin(l/2)*Math.sin(l/2)+Math.cos(n)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}function ie(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Error("Input argument must be an array of lat/lng pairs.");Array.isArray(e[0][0])||(e=[e]);var t,a=0,r=Object(c.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;a+=n.reduce((function(e,t){return{d:e.d+se(e.lat,e.lng,t[0],t[1]),lat:t[0],lng:t[1]}}),{d:0,lat:n[0][0],lng:n[0][1]}).d}}catch(o){r.e(o)}finally{r.f()}return a}var ue=[[52.515124,13.359583],[52.514654,13.351429],[52.51515,13.350614],[52.515176,13.349884],[52.514941,13.349241],[52.514497,13.348768],[52.513296,13.331645],[52.512773,13.322933],[52.513139,13.322376],[52.514549,13.322333],[52.517631,13.324993],[52.52207,13.328555],[52.522201,13.328512],[52.522775,13.329757],[52.523846,13.329886],[52.525125,13.336967],[52.52577800000001,13.339456],[52.522253,13.36808],[52.520765,13.370655],[52.520817,13.373616000000002],[52.522671,13.37705],[52.522175,13.377436],[52.523898,13.387478],[52.527188,13.387135],[52.529407,13.397520000000002],[52.529799,13.402456],[52.529773,13.4037],[52.528572,13.411124],[52.527214,13.415759],[52.52536,13.420008],[52.522096,13.416661],[52.518806000000005,13.427389],[52.518911,13.428763],[52.517709,13.428076],[52.513426,13.424171],[52.512147,13.422669],[52.509639,13.421295],[52.510971,13.416403],[52.501698,13.409279],[52.499164,13.417648],[52.49848500000001,13.418592],[52.48782400000001,13.425329],[52.486308,13.424042],[52.487301,13.421381000000002],[52.489052,13.408077],[52.492188,13.391255],[52.493625,13.38353],[52.491535,13.376749],[52.491535,13.376688],[52.492397,13.372139],[52.493207,13.368338],[52.494331,13.361171000000002],[52.491456,13.360828],[52.490307,13.359798],[52.48981,13.353189000000002],[52.489000000000004,13.34482],[52.480271,13.344906],[52.479017,13.344649],[52.47818,13.343576],[52.47114800000001,13.334907000000001],[52.468796,13.332761],[52.471358,13.32877],[52.471567,13.324049],[52.471619,13.319672],[52.470364,13.317612],[52.469188,13.31435],[52.4689,13.313363000000003],[52.467358,13.3089],[52.468037,13.30757],[52.467645,13.306454],[52.468325,13.301519],[52.468717,13.298858],[52.470364,13.290404],[52.470887,13.28976],[52.470678,13.288987],[52.47365800000001,13.285211],[52.476978,13.280791],[52.480167,13.286026000000001],[52.48129,13.288387000000002],[52.48772,13.300317],[52.488373,13.301605],[52.48819,13.306325],[52.490699,13.315166],[52.4913,13.312462],[52.491953,13.309501],[52.494304,13.310273],[52.498694,13.312333],[52.500523,13.313192],[52.502404,13.32568],[52.504415,13.334606],[52.504546,13.335636],[52.502168000000005,13.341902],[52.501437,13.342717],[52.501489,13.344219],[52.500679,13.347824],[52.499164,13.353961],[52.499086,13.355463000000002],[52.49906,13.355549],[52.497806,13.362158],[52.499687,13.362802],[52.504284,13.366707],[52.505956,13.368166],[52.50815,13.369711],[52.50883,13.370054],[52.509038,13.371428],[52.509613,13.377093000000002],[52.510188,13.387607],[52.510344,13.391898],[52.510762,13.393744],[52.513087000000006,13.3934],[52.514027,13.3931],[52.513949,13.391426],[52.514758,13.391083],[52.514941,13.389152],[52.516978,13.388723],[52.516299,13.378208000000003],[52.515881,13.371986]];a(107),a(108);te.a.Icon.Default.imagePath="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/images/";var he=Object(d.a)({palette:{primary:{main:"#009374"},secondary:{main:"#1f82c0"}}}),me=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).handleToggleTrack=function(t){return function(){var a=e.state.tracks;void 0!==a[t]&&(a[t].checked=!a[t].checked,e.setState({tracks:a}))}},e.handleRemoveTrack=function(t){return function(){e.setState((function(e){var a=Object(s.a)(e.tracks);return a.splice(t,1),{tracks:a}}),e.updateBounds)}},e.handleNewTrack=function(t,a){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#1f82c0";e.setState((function(e){var n=Object(s.a)(e.tracks);return n.push({name:t,positions:a,checked:!0,color:r,weight:3,dashArray:0,distance:ie(a),bounds:oe(a),showMoreMenuAnchorEl:null}),{tracks:n}}),e.updateBounds)},e.handleTrackHover=function(t,a){return function(){var r=e.state.tracks;void 0!==r[t]&&(r[t].weight=a?5:3,e.setState({tracks:r}))}},e.handleToggleAll=function(){var t,a=e.state.tracks,r=a.every((function(e){return e.checked})),n=Object(c.a)(a);try{for(n.s();!(t=n.n()).done;){t.value.checked=!r}}catch(o){n.e(o)}finally{n.f()}e.setState({tracks:a})},e.handleOpenMoreMenu=function(t){e.setState({showMoreMenuAnchorEl:t.currentTarget})},e.handleCloseMoreMenu=function(){e.setState({showMoreMenuAnchorEl:null})},e.handleRemoveSelected=function(){var t=e.state.tracks.filter((function(e){return!e.checked}));e.setState({tracks:t})},e.handleRemoveAll=function(){e.setState({tracks:[]})},e.handleTrackOpenMoreMenu=function(t){return function(a){var r=e.state.tracks;void 0!==r[t]&&(r[t].showMoreMenuAnchorEl=a.currentTarget,e.setState({tracks:r}))}},e.handleTrackCloseMoreMenu=function(t){return function(){var a=e.state.tracks;void 0!==a[t]&&(a[t].showMoreMenuAnchorEl=null,e.setState({tracks:a}))}},e.handleToggleSettings=function(t){return function(){var a=e.state.settings;a[t]=!e.state.settings[t],e.setState((function(e){return{settings:a}}))}},e.handleTrackEditOpen=function(t){return function(){e.setState({showEditTrack:!0,currentTrackIdToEdit:t})}},e.handleTrackEditClose=function(){var t=e.state.tracks;t[e.state.currentTrackIdToEdit].showMoreMenuAnchorEl=null,e.setState({showEditTrack:!1,currentTrackIdToEdit:null,tracks:t})},e.handleTrackEditName=function(t){var a=e.state.tracks;void 0!==a[e.state.currentTrackIdToEdit]&&(a[e.state.currentTrackIdToEdit].name=t.target.value,e.setState({tracks:a}))},e.handleTrackEditColor=function(t){var a=e.state.tracks;void 0!==a[e.state.currentTrackIdToEdit]&&(a[e.state.currentTrackIdToEdit].color=t.target.value,e.setState({tracks:a}))},e.handleTrackEditDashArray=function(t,a){var r=e.state.tracks;void 0!==r[e.state.currentTrackIdToEdit]&&(r[e.state.currentTrackIdToEdit].dashArray=a,e.setState({tracks:r}))},e.state={showSettings:!0,showMoreMenuAnchorEl:null,showEditTrack:!1,currentTrackIdToEdit:null,settings:{autofit:!0},tracks:[],center:[51.505,-.09],zoom:13},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.handleNewTrack("Berlin Marathon",ue)}},{key:"render",value:function(){var e,t,a,r,o=this,l=this.props.classes;return n.a.createElement(f.a,{theme:he},n.a.createElement("div",{className:l.root},"defaultTrackStrokeDasharray",n.a.createElement(v.a,null),n.a.createElement(E.a,{position:"fixed",className:l.appBar},n.a.createElement(P.a,null,n.a.createElement(D.a,{variant:"h6",className:l.title},"KML Viewer"))),n.a.createElement(M.a,{className:l.drawer,variant:"permanent",classes:{paper:l.drawerPaper}},n.a.createElement("div",{className:l.toolbar}),n.a.createElement(w.a,{dense:!0},n.a.createElement(S.a,{button:!0,onClick:this.handleToggleAll},n.a.createElement(C.a,{classes:{primary:l.listItemSubheader},primary:"Files"}),n.a.createElement(A.a,null,n.a.createElement(T.a,{edge:"end",onClick:this.handleOpenMoreMenu},n.a.createElement(J.a,null)),n.a.createElement(N.a,{open:Boolean(this.state.showMoreMenuAnchorEl),anchorReference:"anchorEl",anchorEl:this.state.showMoreMenuAnchorEl,onClose:this.handleCloseMoreMenu,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},n.a.createElement(j.a,null,n.a.createElement(x.a,{button:!0,onClick:this.handleRemoveSelected},"Remove selected"),n.a.createElement(x.a,{button:!0,onClick:this.handleRemoveAll},"Remove all"))))),this.state.tracks.map((function(e,t){return n.a.createElement(S.a,{button:!0,key:e.name,onClick:o.handleToggleTrack(t),onMouseEnter:o.handleTrackHover(t,!0),onMouseLeave:o.handleTrackHover(t,!1)},n.a.createElement(O.a,null,n.a.createElement(k.a,{edge:"start",checked:e.checked,tabIndex:-1,disableRipple:!0})),n.a.createElement(C.a,{classes:{primary:l.listItemPrimary},primary:e.name,secondary:e.checked?e.distance.toFixed(2)+" km":""}),n.a.createElement(A.a,null,n.a.createElement(T.a,{edge:"end",onClick:o.handleTrackOpenMoreMenu(t)},n.a.createElement(J.a,null)),n.a.createElement(N.a,{open:Boolean(e.showMoreMenuAnchorEl),anchorReference:"anchorEl",anchorEl:e.showMoreMenuAnchorEl,onClose:o.handleTrackCloseMoreMenu(t),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},n.a.createElement(j.a,null,n.a.createElement(x.a,{button:!0,onClick:o.handleTrackEditOpen(t)},n.a.createElement(O.a,null,n.a.createElement(U.a,null)),n.a.createElement(C.a,null,"Edit")),n.a.createElement(x.a,{button:!0,onClick:o.handleRemoveTrack(t)},n.a.createElement(O.a,null,n.a.createElement(Y.a,null)),n.a.createElement(C.a,null,"Remove"))))))})),n.a.createElement(S.a,null,n.a.createElement(K,{onNewTrack:this.handleNewTrack}))),n.a.createElement(b.a,null),n.a.createElement(w.a,{subheader:n.a.createElement(I.a,null,"Settings"),dense:!0},n.a.createElement(y.a,{in:this.state.showSettings},n.a.createElement(S.a,null,n.a.createElement(C.a,{classes:{primary:l.listItemPrimary},primary:"Autofit"}),n.a.createElement(R.a,{edge:"end",checked:this.state.settings.autofit,onChange:this.handleToggleSettings("autofit")}))))),n.a.createElement(G.a,{open:this.state.showEditTrack,onClose:this.handleTrackEditClose,"aria-labelledby":"form-dialog-title"},n.a.createElement(H.a,{id:"form-dialog-title"},null===(e=this.state.tracks[this.state.currentTrackIdToEdit])||void 0===e?void 0:e.name),n.a.createElement(F.a,null,n.a.createElement(z.a,{autoFocus:!0,margin:"dense",id:"name",label:"Name",type:"text",value:null===(t=this.state.tracks[this.state.currentTrackIdToEdit])||void 0===t?void 0:t.name,onChange:this.handleTrackEditName,fullWidth:!0}),n.a.createElement(z.a,{autoFocus:!0,margin:"dense",id:"color",label:"Color",type:"text",value:null===(a=this.state.tracks[this.state.currentTrackIdToEdit])||void 0===a?void 0:a.color,onChange:this.handleTrackEditColor,fullWidth:!0}),n.a.createElement(D.a,{id:"track-dasharray-slider",gutterBottom:!0},"Dash array"),n.a.createElement(B.a,{value:null===(r=this.state.tracks[this.state.currentTrackIdToEdit])||void 0===r?void 0:r.dashArray,onChange:this.handleTrackEditDashArray,getAriaValueText:function(e){return e.toString()},"aria-labelledby":"track-dasharray-slider",valueLabelDisplay:"auto",step:1,marks:!0,min:0,max:10})),n.a.createElement(L.a,null,n.a.createElement(g.a,{onClick:this.handleTrackEditClose,color:"primary"},"Close"))),n.a.createElement("main",{className:l.content},n.a.createElement("div",{className:l.toolbar}),n.a.createElement("div",{className:l.leafletMap},n.a.createElement(ce,{tracks:this.state.tracks,autofit:this.state.settings.autofit})))))}}]),a}(r.Component),de=Object(p.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},title:{flexGrow:1},drawer:{width:320,flexShrink:0},drawerPaper:{width:320},content:{flexGrow:1,height:"100vh"},listItemSubheader:{color:e.palette.text.secondary,fontWeight:e.typography.fontWeightMedium},listItemPrimary:{display:"block",overflow:"hidden",textOverflow:"ellipsis"},toolbar:e.mixins.toolbar,leafletMap:{height:"calc(100% - 64px)"}}}))(me),pe=document.getElementById("root");l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(de,null)),pe)},99:function(e,t,a){e.exports=a(110)}},[[99,1,2]]]);
//# sourceMappingURL=main.07dd6855.chunk.js.map